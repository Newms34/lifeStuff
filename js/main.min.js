!function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?module.exports=factory(require("jquery")):root.bootbox=factory(root.jQuery)}(this,function init($,undefined){"use strict";function _t(key){var locale=locales[defaults.locale];return locale?locale[key]:locales.en[key]}function processCallback(e,dialog,callback){e.stopPropagation(),e.preventDefault();var preserveDialog=$.isFunction(callback)&&callback.call(dialog,e)===!1;preserveDialog||dialog.modal("hide")}function getKeyLength(obj){var k,t=0;for(k in obj)t++;return t}function each(collection,iterator){var index=0;$.each(collection,function(key,value){iterator(key,value,index++)})}function sanitize(options){var buttons,total;if("object"!=typeof options)throw new Error("Please supply an object of options");if(!options.message)throw new Error("Please specify a message");return options=$.extend({},defaults,options),options.buttons||(options.buttons={}),buttons=options.buttons,total=getKeyLength(buttons),each(buttons,function(key,button,index){if($.isFunction(button)&&(button=buttons[key]={callback:button}),"object"!==$.type(button))throw new Error("button with key "+key+" must be an object");button.label||(button.label=key),button.className||(total<=2&&index===total-1?button.className="btn-primary":button.className="btn-default")}),options}function mapArguments(args,properties){var argn=args.length,options={};if(argn<1||argn>2)throw new Error("Invalid argument length");return 2===argn||"string"==typeof args[0]?(options[properties[0]]=args[0],options[properties[1]]=args[1]):options=args[0],options}function mergeArguments(defaults,args,properties){return $.extend(!0,{},defaults,mapArguments(args,properties))}function mergeDialogOptions(className,labels,properties,args){var baseOptions={className:"bootbox-"+className,buttons:createLabels.apply(null,labels)};return validateButtons(mergeArguments(baseOptions,args,properties),labels)}function createLabels(){for(var buttons={},i=0,j=arguments.length;i<j;i++){var argument=arguments[i],key=argument.toLowerCase(),value=argument.toUpperCase();buttons[key]={label:_t(value)}}return buttons}function validateButtons(options,buttons){var allowedButtons={};return each(buttons,function(key,value){allowedButtons[value]=!0}),each(options.buttons,function(key){if(allowedButtons[key]===undefined)throw new Error("button key "+key+" is not allowed (options are "+buttons.join("\n")+")")}),options}var templates={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},defaults={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},exports={};exports.alert=function(){var options;if(options=mergeDialogOptions("alert",["ok"],["message","callback"],arguments),options.callback&&!$.isFunction(options.callback))throw new Error("alert requires callback property to be a function when provided");return options.buttons.ok.callback=options.onEscape=function(){return!$.isFunction(options.callback)||options.callback.call(this)},exports.dialog(options)},exports.confirm=function(){var options;if(options=mergeDialogOptions("confirm",["cancel","confirm"],["message","callback"],arguments),options.buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,!1)},options.buttons.confirm.callback=function(){return options.callback.call(this,!0)},!$.isFunction(options.callback))throw new Error("confirm requires a callback");return exports.dialog(options)},exports.prompt=function(){var options,defaults,dialog,form,input,shouldShow,inputOptions;if(form=$(templates.form),defaults={className:"bootbox-prompt",buttons:createLabels("cancel","confirm"),value:"",inputType:"text"},options=validateButtons(mergeArguments(defaults,arguments,["title","callback"]),["cancel","confirm"]),shouldShow=options.show===undefined||options.show,options.message=form,options.buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,null)},options.buttons.confirm.callback=function(){var value;switch(options.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":value=input.val();break;case"checkbox":var checkedItems=input.find("input:checked");value=[],each(checkedItems,function(_,item){value.push($(item).val())})}return options.callback.call(this,value)},options.show=!1,!options.title)throw new Error("prompt requires a title");if(!$.isFunction(options.callback))throw new Error("prompt requires a callback");if(!templates.inputs[options.inputType])throw new Error("invalid prompt type");switch(input=$(templates.inputs[options.inputType]),options.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":input.val(options.value);break;case"select":var groups={};if(inputOptions=options.inputOptions||[],!$.isArray(inputOptions))throw new Error("Please pass an array of input options");if(!inputOptions.length)throw new Error("prompt with select requires options");each(inputOptions,function(_,option){var elem=input;if(option.value===undefined||option.text===undefined)throw new Error("given options in wrong format");option.group&&(groups[option.group]||(groups[option.group]=$("<optgroup/>").attr("label",option.group)),elem=groups[option.group]),elem.append("<option value='"+option.value+"'>"+option.text+"</option>")}),each(groups,function(_,group){input.append(group)}),input.val(options.value);break;case"checkbox":var values=$.isArray(options.value)?options.value:[options.value];if(inputOptions=options.inputOptions||[],!inputOptions.length)throw new Error("prompt with checkbox requires options");if(!inputOptions[0].value||!inputOptions[0].text)throw new Error("given options in wrong format");input=$("<div/>"),each(inputOptions,function(_,option){var checkbox=$(templates.inputs[options.inputType]);checkbox.find("input").attr("value",option.value),checkbox.find("label").append(option.text),each(values,function(_,value){value===option.value&&checkbox.find("input").prop("checked",!0)}),input.append(checkbox)})}return options.placeholder&&input.attr("placeholder",options.placeholder),options.pattern&&input.attr("pattern",options.pattern),options.maxlength&&input.attr("maxlength",options.maxlength),form.append(input),form.on("submit",function(e){e.preventDefault(),e.stopPropagation(),dialog.find(".btn-primary").click()}),dialog=exports.dialog(options),dialog.off("shown.bs.modal"),dialog.on("shown.bs.modal",function(){input.focus()}),shouldShow===!0&&dialog.modal("show"),dialog},exports.dialog=function(options){options=sanitize(options);var dialog=$(templates.dialog),innerDialog=dialog.find(".modal-dialog"),body=dialog.find(".modal-body"),buttons=options.buttons,buttonStr="",callbacks={onEscape:options.onEscape};if($.fn.modal===undefined)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(each(buttons,function(key,button){buttonStr+="<button data-bb-handler='"+key+"' type='button' class='btn "+button.className+"'>"+button.label+"</button>",callbacks[key]=button.callback}),body.find(".bootbox-body").html(options.message),options.animate===!0&&dialog.addClass("fade"),options.className&&dialog.addClass(options.className),"large"===options.size?innerDialog.addClass("modal-lg"):"small"===options.size&&innerDialog.addClass("modal-sm"),options.title&&body.before(templates.header),options.closeButton){var closeButton=$(templates.closeButton);options.title?dialog.find(".modal-header").prepend(closeButton):closeButton.css("margin-top","-10px").prependTo(body)}return options.title&&dialog.find(".modal-title").html(options.title),buttonStr.length&&(body.after(templates.footer),dialog.find(".modal-footer").html(buttonStr)),dialog.on("hidden.bs.modal",function(e){e.target===this&&dialog.remove()}),dialog.on("shown.bs.modal",function(){dialog.find(".btn-primary:first").focus()}),"static"!==options.backdrop&&dialog.on("click.dismiss.bs.modal",function(e){dialog.children(".modal-backdrop").length&&(e.currentTarget=dialog.children(".modal-backdrop").get(0)),e.target===e.currentTarget&&dialog.trigger("escape.close.bb")}),dialog.on("escape.close.bb",function(e){callbacks.onEscape&&processCallback(e,dialog,callbacks.onEscape)}),dialog.on("click",".modal-footer button",function(e){var callbackKey=$(this).data("bb-handler");processCallback(e,dialog,callbacks[callbackKey])}),dialog.on("click",".bootbox-close-button",function(e){processCallback(e,dialog,callbacks.onEscape)}),dialog.on("keyup",function(e){27===e.which&&dialog.trigger("escape.close.bb")}),$(options.container).append(dialog),dialog.modal({backdrop:!!options.backdrop&&"static",keyboard:!1,show:!1}),options.show&&dialog.modal("show"),dialog},exports.setDefaults=function(){var values={};2===arguments.length?values[arguments[0]]=arguments[1]:values=arguments[0],$.extend(defaults,values)},exports.hideAll=function(){return $(".bootbox").modal("hide"),exports};var locales={bg_BG:{OK:"Ок",CANCEL:"Отказ",CONFIRM:"Потвърждавам"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"قبول",CANCEL:"لغو",CONFIRM:"تایید"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},hu:{OK:"OK",CANCEL:"Mégsem",CONFIRM:"Megerősít"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"ตกลง",CANCEL:"ยกเลิก",CONFIRM:"ยืนยัน"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return exports.addLocale=function(name,values){return $.each(["OK","CANCEL","CONFIRM"],function(_,v){if(!values[v])throw new Error("Please supply a translation for '"+v+"'")}),locales[name]={OK:values.OK,CANCEL:values.CANCEL,CONFIRM:values.CONFIRM},exports},exports.removeLocale=function(name){return delete locales[name],exports},exports.setLocale=function(name){return exports.setDefaults("locale",name)},exports.init=function(_$){return init(_$||$)},exports});var fl={bird:["mouse","hamster","rabbit","herb","deciduous","evergreen","chestnut","corn","rice","cactus","flower","cherry","bug","ant","ladybug","spider"],mouse:["chestnut","corn","rice","evergreen","deciduous","herb","palm","cactus","flower","cherry","sunflower","blossom","bug","ant","ladybug","spider","maple"],cow:["grass","blossom","tulip","whiteflower","flower","herb"],tiger:["cow","monkey","mouse","dog","pig","rabbit","cat","horse","hamster","wolf","bird"],monkey:["corn","rice","deciduous","herb","palm","flower","cherry","mouse","hamster","frog","pig","bug","ant","bird"],dog:["hamster","mouse","pig","frog","rabbit","cat","bird"],pig:["bug","ant","bee","grass","cherry","deciduous","spider","mouse","herb","rice","corn","blossom","chestnut"],frog:["bug","ant","bee","ladybug","spider"],rabbit:["grass","herb","cherry","sunflower","deciduous","herbivore","chestnut","maple","whiteflower","flower"],cat:["mouse","hamster","pig","bird"],dragon:["mouse","cow","tiger","monkey","dog","pig","frog","rabbit","cat","horse","hamster","wolf","bear","panda","bird"],horse:["grass","herb","deciduous","evergreen","tulip","blossom","whiteflower","flower","corn","rice","palm"],hamster:["chestnut","blossom","maple","herb","palm","deciduous","flower"],wolf:["rabbit","mouse","hamster","horse","cow","pig","cat","bird"],bear:["rabbit","mouse","hamster","horse","pig","cow","cat","dog","cat","chestnut","corn","cherry","herb","rice","flower","ant"],panda:["grass"],bug:["chestnut","deciduous","cherry","corn","rice","ant","flower","grass","herb","bee","spider","ladybug"],ant:["bug","cherry","corn","rice","herb","bee","spider","ladybug","chestnut"],bee:["flower","whiteflower","herb","deciduous","evergreen"],ladybug:["ant","bug","spider"],spider:["ant","bug","ladybug","bee"]},orgStats={bird:{img:"\uD83D\uDC26",spawnChance:1,gestation:21,timeToMature:104,type:"omni"},mouse:{img:"\uD83D\uDC01",spawnChance:1,gestation:20,timeToMature:2,type:"omni"},cow:{img:"\uD83D\uDC04",spawnChance:1,gestation:284,timeToMature:676,type:"herbi"},tiger:{img:"\uD83D\uDC05",spawnChance:1,gestation:102,timeToMature:156,type:"pred"},monkey:{img:"\uD83D\uDC12",spawnChance:1,gestation:175,timeToMature:156,type:"omni"},dog:{img:"\uD83D\uDC15",spawnChance:1,gestation:63,timeToMature:104,type:"pred"},pig:{img:"\uD83D\uDC16",spawnChance:1,gestation:115,timeToMature:30,type:"omni"},frog:{img:"\uD83D\uDC38",spawnChance:1,gestation:21,timeToMature:52,type:"pred"},rabbit:{img:"\uD83D\uDC07",spawnChance:1,gestation:30,timeToMature:25,type:"herbi"},cat:{img:"\uD83D\uDC08",spawnChance:1,gestation:50,timeToMature:40,type:"pred"},dragon:{img:"\uD83D\uDC09",spawnChance:1,gestation:390,timeToMature:780,type:"pred"},horse:{img:"\uD83D\uDC0E",spawnChance:1,gestation:340,timeToMature:65,type:"herbi"},hamster:{img:"\uD83D\uDC39",spawnChance:1,gestation:22,timeToMature:5,type:"omni"},wolf:{img:"\uD83D\uDC3A",spawnChance:1,gestation:68,timeToMature:156,type:"pred"},bear:{img:"\uD83D\uDC3B",spawnChance:1,gestation:215,timeToMature:208,type:"omni"},panda:{img:"\uD83D\uDC3C",spawnChance:1,gestation:127,timeToMature:312,type:"herbi"},bug:{img:"\uD83D\uDC1B",spawnChance:1,gestation:10,timeToMature:5,type:"omni"},ant:{img:"\uD83D\uDC1C",spawnChance:1,gestation:10,timeToMature:5,type:"omni"},bee:{img:"\uD83D\uDC1D",spawnChance:1,gestation:10,timeToMature:5,type:"herbi"},ladybug:{img:"\uD83D\uDC1E",spawnChance:1,gestation:15,timeToMature:5,type:"pred"},spider:{img:"\uD83D\uDD77",spawnChance:1,gestation:21,timeToMature:5,type:"pred"},chestnut:{img:"\uD83C\uDF30",spawnChance:1,gestation:10,timeToMature:208,type:"prod"},corn:{img:"\uD83C\uDF3D",spawnChance:1,gestation:10,timeToMature:11,type:"prod"},rice:{img:"\uD83C\uDF3E",spawnChance:1,gestation:10,timeToMature:16,type:"prod"},herb:{img:"\uD83C\uDF3F",spawnChance:1,gestation:10,timeToMature:10,type:"prod"},maple:{img:"\uD83C\uDF41",spawnChance:1,gestation:10,timeToMature:208,type:"prod"},cactus:{img:"\uD83C\uDF35",spawnChance:1,gestation:10,timeToMature:208,type:"prod"},evergreen:{img:"\uD83C\uDF32",spawnChance:1,gestation:10,timeToMature:208,type:"prod"},deciduous:{img:"\uD83C\uDF33",spawnChance:1,gestation:10,timeToMature:208,type:"prod"},palm:{img:"\uD83C\uDF34",spawnChance:1,gestation:10,timeToMature:364,type:"prod"},flower:{img:"\u2698",spawnChance:1,gestation:10,timeToMature:7,type:"prod"},whiteflower:{img:"\u2740",spawnChance:1,gestation:10,timeToMature:7,type:"prod"},tulip:{img:"\uD83C\uDF37",spawnChance:1,gestation:10,timeToMature:7,type:"prod"},cherry:{img:"\uD83C\uDF52",spawnChance:1,gestation:10,timeToMature:104,type:"prod"},sunflower:{img:"\uD83C\uDF3B",spawnChance:1,gestation:10,timeToMature:7,type:"prod"},blossom:{img:"\uD83C\uDF3C",spawnChance:1,gestation:10,timeToMature:7,type:"prod"},grass:{img:"|",spawnChance:1,gestation:10,timeToMature:2,type:"prod"}},testPics=function(){Object.keys(orgStats);for(var n in orgStats)console.log(n,orgStats[n].img.replace(/s/g,"\\"))},maxNum=100,orgs=[],w=$(window).width()-10,h=$(window).height()-10,d=w,timeDelta,itNum=0,orgConst=function(x,y,z,spec,type,sex){this.pos={x:x,y:y,z:"prod"==type?h:z},this.vel={dx:1,dy:1,dz:"prod"==type?0:1},this.hp=100,this.id=Math.floor(9999999999999*Math.random()).toString(32),this.type=type,this.spec=spec,this.eats=fl[this.spec],this.sex=sex,this.vis=10,this.targ=null,this.isDef=50,this.matureTime=orgStats[this.spec].timeToMature,this.mode="none",this.coolDown=0,this.lastMate=0,this.mateTimerMax=orgStats[this.spec].gestation,this.hunger=0};orgConst.prototype.pred=function(){if(console.log("STUFF:",getDist(this,orgs[this.targ]),this.eats.indexOf(orgs[this.targ].spec)),getDist(this,orgs[this.targ])<this.vis&&this.eats.indexOf(orgs[this.targ].spec)!=-1&&this.hp){var rollChance=orgs[this.targ].isDef?10:3;Math.floor(Math.random()*rollChance)<1?(this.hp+=orgs[this.targ].hp,this.hp>100&&(this.hp=100),console.log(this.spec,this.id,"preyed on",orgs[this.targ].spec,orgs[this.targ].id,"successfully!"),orgs[this.targ].hp=0):(rollChance=orgs[this.targ].isDef?3:20,Math.floor(Math.random()*rollChance)<1&&"prod"!=orgs[this.targ].type&&(this.hp-=18),console.log(this.spec,this.id,"attempted to prey on",orgs[this.targ].spec,orgs[this.targ].id,"but failed!"))}this.mode="none",this.coolDown=100,this.pickNewTarg()},orgConst.prototype.mate=function(){return Math.random()>.1&&getDist(this,orgs[this.targ])<this.vis&&this.hp&&1==this.sex&&"mate"==orgs[this.targ].mode&&2==orgs[this.targ].sex&&orgs[this.targ].hp&&orgs[this.targ].spec==this.spec?(console.log(this.spec,this.id,"mated with",orgs[this.targ].spec,orgs[this.targ].id),birth(this,orgs[this.targ]),"b"):(this.mode="none",this.coolDown=100,void this.pickNewTarg())},orgConst.prototype.fight=function(){if(getDist(this,orgs[this.targ])<this.vis&&this.hp){var rollChance=orgs[this.targ].spec==this.spec?15:3,whichWins=Math.floor(2*Math.random());Math.floor(Math.random()*rollChance)<1?whichWins?(console.log(this.spec,this.id,"fought",orgs[this.targ].spec,orgs[this.targ].id,"and won."),orgs[this.targ].hp-=10):(console.log(this.spec,this.id,"fought",orgs[this.targ].spec,orgs[this.targ].id,"and lost."),this.hp-=10):console.log("Fight between",this.spec,this.id,"and",orgs[this.targ].spec,orgs[this.targ].id,"with no injuries")}this.mode="none",this.coolDown=100,this.pickNewTarg()},orgConst.prototype.pickNewTarg=function(){this.targ=Math.floor(Math.random()*orgs.length);for(var validMatch=!1;orgs[this.targ].id==this.id||"prod"==orgs[this.targ].type&&"carni"==this.type&&validMatch;)"pred"==this.mode&&this.eats.indexOf(orgs[this.targ].spec)!=-1?validMatch=!0:"pred"!=this.mode&&(validMatch=!0),this.targ=Math.floor(Math.random()*orgs.length);console.log(this.spec,this.id,"picked",orgs[this.targ].spec,orgs[this.targ].id)},orgConst.prototype.pickMode=function(){this.mode="wander",!this.matureTime||this.matureTime<1?this.hunger/100>this.lastMate/this.mateTimerMax?Math.random()<this.hunger/100?this.mode="pred":Math.random()>this.lastMate/this.mateTimerMax&&(this.mode="mate"):Math.random()>this.lastMate/this.mateTimerMax?this.mode="mate":Math.random()>this.hunger/100&&(this.mode="pred"):Math.random()>this.hunger/100&&(this.mode="pred")};var die=function(n){console.log(orgs[n],"died!");var theId=orgs[n].id;orgs.splice(n,1);for(var orgDivs=$(".one-org"),r=0;r<orgDivs.length;r++)if(console.log("LOOKING TO DELETE",n),orgDivs[r].id==theId){$(orgDivs[r]).remove();break}for(var i=0;i<orgs.length;i++)console.log("LOOKING TO DELETE",n),orgs[i].targ==n?orgs[i].pickNewTarg():orgs[i].targ>n&&orgs[i].targ--},birth=function(f,m){var newBeast=new orgConst(f.x,f.y,f.z,f.spec,f.type,Math.floor(2*Math.random())+1);orgs.push(newBeast);var newOrgDiv=document.createElement("div");newOrgDiv.className="one-org",newOrgDiv.innerHTML=orgStats[newBeast.spec].img,newOrgDiv.style.left=x+"px",newOrgDiv.style.top=y+"px",newOrgDiv.style.transform="translateZ("+z+"px)",newOrgDiv.id=newBeastie.id,$("#field").append(newOrgDiv)},getDist=function(o,t){var a=Math.abs(o.pos.x-t.pos.x),b=Math.abs(o.pos.y-t.pos.y);Math.abs(o.pos.z-t.pos.z);return Math.floor(Math.sqrt(Math.pow(a,2)+Math.pow(b,2)))},step=function(){for(var numOrgs=orgs.length,i=0;i<numOrgs;i++)if(orgs[i].hp<1&&(die(i),numOrgs--,i--),"none"!=orgs[i].mode||orgs[i].coolDown||orgs[i].matureTime?(orgs[i].coolDown>0||orgs[i].matureTime>0)&&(orgs[i].coolDown&&orgs[i].coolDown>0&&orgs[i].coolDown--,orgs[i].matureTime&&orgs[i].matureTime>0&&orgs[i].matureTime--):(orgs[i].pickMode(),orgs[i].pickNewTarg()),orgs[i].hunger<100?orgs[i].hunger++:orgs[i].hp--,orgs[i].lastMate<100&&orgs[i].lastMate++,"prod"!=orgs[i].type)if(!orgs[i].targ||getDist(orgs[i],orgs[orgs[i].targ])>orgs[i].vis)orgs[i].targ&&(orgs[i].pos.x>orgs[orgs[i].targ].pos.x?orgs[i].vel.dx=-1:orgs[i].vel.dx=1,orgs[i].pos.y>orgs[orgs[i].targ].pos.y?orgs[i].vel.dy=-1:orgs[i].vel.dy=1,orgs[i].pos.z>orgs[orgs[i].targ].pos.z?orgs[i].vel.dz=-1:orgs[i].vel.dz=1),(orgs[i].pos.x+orgs[i].vel.dx>w||orgs[i].pos.x+orgs[i].vel.dx<0)&&(orgs[i].vel.dx=-1*orgs[i].vel.dx),(orgs[i].pos.y+orgs[i].vel.dy>h||orgs[i].pos.y+orgs[i].vel.dy<0)&&(orgs[i].vel.dy=-1*orgs[i].vel.dy),(orgs[i].pos.z+orgs[i].vel.dz>d||orgs[i].pos.z+orgs[i].vel.dz<0)&&(orgs[i].vel.dz=-1*orgs[i].vel.dz),orgs[i].pos.x+=orgs[i].vel.dx,orgs[i].pos.y+=orgs[i].vel.dy,orgs[i].pos.z+=orgs[i].vel.dz,$("#"+orgs[i].id).css({left:orgs[i].pos.x+"px",top:orgs[i].pos.y+"px",transform:"translateZ("+orgs[i].pos.z+"px)"});else{if("pred"==orgs[i].mode)orgs[i].pred();else if("mate"==orgs[i].mode){var sx=orgs[i].mate();"b"==sx&&numOrgs++}else"wander"==orgs[i].mode&&"prod"!=orgs[orgs[i].targ].type&&orgs[i].fight();orgs[i].pickNewTarg()}itNum++,console.log(orgs[0].pos)},mainTimer,startMe=function(){var startTime=(new Date).getTime();step();var endTime=(new Date).getTime();timeDelta=endTime-startTime>50?endTime-startTime:50,console.log("frame rate: 1 frame every",timeDelta,"ms."),mainTimer=setInterval(function(){step()},1.5*timeDelta)},setupBox=function(){$("#b-left").css({width:d+"px",height:h+"px","background-image":'url("./img/skyside.jpg")',"background-size":"100% 100%",transform:"rotateY(90deg) translateZ(-"+d/2+"px) translateX("+d/2+"px)"}),$("#b-right").css({width:d+"px",height:h+"px","background-image":'url("./img/skyside.jpg")',"background-size":"100% 100%",transform:"rotateY(90deg) translateZ("+d/2+"px) translateX("+d/2+"px)"}),$("#b-top").css({width:w+"px",height:d+"px","background-image":'url("./img/skytop.jpg")',"background-size":"100% 100%",transform:"rotateX(90deg) translateZ("+d/2+"px) translateY(-"+d/2+"px)"}),$("#b-back").css({width:w+"px",height:h+"px","background-image":'url("./img/skyside.jpg")',"background-size":"100% 100%",transform:"translateZ(-"+d+"px)","transform-style":"preserve-3d"}),$("#b-bottom").css({width:w+"px",height:d+"px","background-image":'url("./img/dirt.jpg")',transform:"rotateX(90deg) translateZ(30px) translateY(-"+d/2+"px)",overflow:"hidden"})};window.onkeyup=function(e){83==e.which&&clearInterval(mainTimer)},setupBox();var app=angular.module("pickerApp",[]).controller("pik-cont",function($scope){$scope.orgs=[],$scope.pikActive=!0;for(var tax in orgStats){var newOrg={name:tax,img:orgStats[tax].img,gestation:orgStats[tax].gestation,timeToMature:orgStats[tax].timeToMature,type:orgStats[tax].type,eats:fl[tax]||"prod",active:!1,quant:0,warns:{pairs:!1,snaks:!1}};$scope.orgs.push(newOrg)}$scope.checkOrgValid=function(o){if(o.warns.pairs=!1,o.warns.snaks=!1,"prod"==o.type)return!1;1==o.quant&&(o.warns.pairs=!0);for(var t=0;t<$scope.orgs.length;t++)if($scope.orgs[t].warns.snaks=!0,"prod"!=$scope.orgs[t].type&&$scope.orgs[t].quant>0)for(var f=0;f<$scope.orgs[t].eats.length;f++)for(var n=0;n<$scope.orgs.length;n++)$scope.orgs[t].eats[f]==$scope.orgs[n].name&&$scope.orgs[n].quant>0&&($scope.orgs[t].warns.snaks=!1);else $scope.orgs[t].quant<1&&($scope.orgs[t].warns.snaks=!1)},$scope.resetNums=function(){for(var t=0;t<$scope.orgs.length;t++)$scope.orgs[t].quant=0,$scope.orgs[t].warns={pairs:!1,snaks:!1}},$scope.makeWorld=function(){for(var hasOrg=!1,t=0;t<$scope.orgs.length;t++)if($scope.orgs[t].quant&&$scope.orgs[t].quant>1){hasOrg=!0;break}hasOrg?$scope.populate():bootbox.confirm("Warning! Your world currently has zero organisms! Are you sure you still want to create it?",function(r){r&&$scope.populate()})},$scope.populate=function(){for(var t=0;t<$scope.orgs.length;t++)for(var q=0;q<$scope.orgs[t].quant;q++){var x=Math.floor(Math.random()*w),y=Math.floor(Math.random()*h),z=Math.floor(Math.random()*d),spec=$scope.orgs[t].name,type=$scope.orgs[t].type,sex=Math.floor(2*Math.random())+1,newBeastie=new orgConst(x,y,z,spec,type,sex);orgs.push(newBeastie);var newOrgDiv=document.createElement("div");newOrgDiv.className="one-org",newOrgDiv.innerHTML=$scope.orgs[t].img,newOrgDiv.style.left=x+"px",newOrgDiv.style.top=y+"px",newOrgDiv.style.transform="translateZ("+z+"px)",newOrgDiv.id=newBeastie.id,$("#field").append(newOrgDiv)}console.log("ORGS",orgs),$scope.pikActive=!1,orgs.length&&orgs.length>0?startMe():$scope.$digest()}});app.filter("typeViewer",function(){var types={omni:"Omnivore: Eats both plants an animals",pred:"Predator (carnivore): Eats animals",herbi:"Herbivore: Eats plants",prod:"Producer: Produces energy from sun"};return function(t){return types[t]}});